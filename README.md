Обмен через сервисы windows

Compiled by Visual Studio 2006, project of 2008 year

<h1>Порядок установки</h1>
<ul>
<li>Скопировать установочные файлы</li>
Файлы "Win1cService.exe" и "config.ini" в каталог "C:\Win1cService"
<li>Прописать настройки в файле настроек</li>
Открыть файл "config.ini" и прописать подключение к базе, а также пользователя базы по правилам строки соединения. Например: 
 [Main]
 Function=Сервис_Функция <- это какая функция будет вызвана
 Base=File="F:\Base";Usr="Exchange"; <- это строка запуска

<li>Запустить инициализацию сервиса</li>
Для этого в каталоге где находиться сервис "C:\Win1cService" нужно запустить сервис с параметром "install". Пример: "Win1cService.exe -install".
<li>Настроить сервис в windows</li>
Далее заходим в сервисы windows. Должен появится сервис "Win1c Exchange Server". По умолчанию он не запущен. Поэтому нужно настроить в соответствии с требованиями.
Рекомендуется сделать его автоматически запускаемым от имени системы.
<li>Проверить, что сервис работает</li>
Заходим в 1С предприятие и смотрим в журнале событий что было COM подключение. Вызывается это подключение через период указанный в текщум складе - "Опрос центра на изменение".
</ul>
<h1>Структура и настройки</h1>
<ul>
<li>Каталог сервиса</li>
Каталогом сервиса является папка откуда будет установлен сервис, нужно чтобы она была не сетевой и не сожержала русских букв.  По умолчанию ее лучше называть "C:\Win1cService".
<li>Сервис</li>
файл Win1cService.exe. Имеет два ключа запуска:
<ul>
<li>install - устанавливается в windows как сервис, после чего на этот файл ссылкается сервис windows.</li>
<li>remove - удаляется из сервисов windows.</li>
</ul>
<li>Файл настроек</li>
config.ini
состоит из двух параметров раздела [Main]
<li>Правила строки соединения</li>
Base
Это строка соединения 1С по правилам COM. Что можно писать в строке соединения можно прочитать в книжке 1С по администрированию, нас интересует только путь к базе и имя пользователя.
путь к базе прписывается как File="путь к базе";
имя пользователя прописывается как "Usr="имя пользователя";
Пароль в настройках специально не прописывается из условий безопасности. Поэтому пароль зашит в зашифрованном виде в самом  сервисе и поставляется автоматически при запуске сервиса.
<li>Сервисы</li>
Function - Сдесь обозначена какая функция будет вызвана.
<li>Настройки в программе 1С</li>
Для работы нужно чтобы в текущем складе был "Опрос центра на изменение". Также не желательно чтобы работали паралельно сервисы запущенные из 1С.
</ul>